(this["webpackJsonppancake-frontend"]=this["webpackJsonppancake-frontend"]||[]).push([[9],{1135:function(e,t,n){var c=n(449),a=n(452),r=n(217),s=n(81),o=n(162),i=n(276),l=n(278),b=n(277),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||i(e)||b(e)||r(e)))return!e.length;var t=a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(l(e))return!c(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},1434:function(e,t,n){"use strict";n.r(t);var c,a,r,s=n(0),o=n(2),i=n(59),l=n(35),b=n(781),d=n.n(b),j=n(1135),u=n.n(j),h=n(130),x=n(50),p=n(78),m=n(16),O=n(26),f=n(756),g=n(170),y=n(9),v=n(214),w=n(402),k=n(95),B=n(869),C=n(814),T=n(744),S=n(826),D=n(7),P=n(4),A=n(1);const E=P.e.label(c||(c=Object(D.a)(["\n  color: ",";\n  display: block;\n  font-weight: 600;\n  margin-bottom: 8px;\n"])),(e=>{let{theme:t}=e;return t.colors.text})),Z=Object(P.e)(E)(a||(a=Object(D.a)(["\n  font-size: 20px;\n"]))),I=Object(P.e)(E)(r||(r=Object(D.a)(["\n  font-size: 12px;\n  text-transform: uppercase;\n"]))),V=e=>{let{children:t}=e;return Object(A.jsx)(o.Zb,{color:"failure",mb:"4px",children:t})},z=e=>{let{errors:t}=e;return Object(A.jsx)(o.n,{mt:"8px",children:t.map((e=>Object(A.jsx)(V,{children:e},e)))})};var L=n(169),F=n.n(L);var M=e=>{let{onRemove:t,onTextInput:n,...c}=e;const[a,r]=Object(s.useState)(!1),[i,l]=Object(s.useState)(!1);return Object(A.jsxs)(o.n,{position:"relative",mb:"16px",children:[Object(A.jsx)(o.db,{...c,onChange:e=>{const{value:t}=e.currentTarget;r(i&&0===t.length),l(!0),n(t)},isWarning:a}),t&&Object(A.jsx)(o.n,{position:"absolute",right:"8px",top:"0px",zIndex:30,children:Object(A.jsx)(o.ab,{variant:"text",onClick:t,children:Object(A.jsx)(o.M,{})})})]})};const Y=()=>({id:F()(),value:""});var H=e=>{let{choices:t,onChange:n}=e;const{t:c}=Object(y.b)(),a=t.filter((e=>e.value.length>0)).length>=2;return Object(A.jsxs)(o.v,{children:[Object(A.jsx)(o.y,{children:Object(A.jsx)(o.X,{as:"h3",scale:"md",children:c("Choices")})}),Object(A.jsxs)(o.w,{children:[t.map(((e,a)=>{let{id:r,value:s}=e;return Object(A.jsx)(M,{scale:"lg",onTextInput:e=>{const c=[...t],a=c.findIndex((e=>e.id===r));c[a].value=e,n(c)},placeholder:c("Input choice text"),value:s,onRemove:a>1?()=>{n(t.filter((e=>e.id!==r)))}:void 0},r)})),Object(A.jsx)(o.r,{type:"button",onClick:()=>{n([...t,Y()])},disabled:!a,children:c("Add Choice")})]})]})},N=n(311),K=n(720),J=n(691);const R=(e,t)=>{if(!Object(N.default)(e)||!Object(N.default)(t))return null;const n=Object(K.default)(e,"yyyy-MM-dd"),c=Object(K.default)(t,"HH:mm:ss");return Object(J.default)("".concat(n,"T").concat(c)).getTime()/1e3};var q=n(746),X=n(79),W=n(828),U=n(827);var Q=e=>{let{block:t,onDismiss:n}=e;const{t:c}=Object(y.b)(),[a,r]=Object(s.useState)(!0),{isLoading:i,total:l,cakeBalance:b,cakeVaultBalance:d,cakePoolBalance:j,poolsBalance:u,cakeBnbLpBalance:h}=Object(W.a)(t,a),{theme:x}=Object(X.a)();return Object(A.jsx)(o.tb,{title:c("Voting Power"),onDismiss:()=>{r(!1),n()},headerBackground:x.colors.gradients.cardHeader,children:Object(A.jsx)(o.n,{mb:"24px",width:"320px",children:i?Object(A.jsx)(o.V,{height:"450px",alignItems:"center",justifyContent:"center",children:Object(A.jsx)(o.Rb,{size:80})}):Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(U.a,{total:l,cakeBalance:b,cakeVaultBalance:d,cakePoolBalance:j,poolsBalance:u,cakeBnbLpBalance:h}),Object(A.jsx)(o.r,{variant:"secondary",onClick:n,width:"100%",mt:"16px",children:c("Close")})]})})})};const _=Object(s.lazy)((()=>Promise.all([n.e(5),n.e(19)]).then(n.bind(null,1421))));t.default=()=>{const[e,t]=Object(s.useState)({name:"",body:"",choices:d()(2).map(Y),startDate:null,startTime:null,endDate:null,endTime:null,snapshot:0}),[n,c]=Object(s.useState)(!1),[a,r]=Object(s.useState)({}),{t:b}=Object(y.b)(),{account:j}=Object(l.c)(),D=Object(h.b)(),{push:P}=Object(i.g)(),{library:E}=Object(m.a)(),{toastSuccess:V,toastError:L}=Object(p.a)(),[F]=Object(o.tc)(Object(A.jsx)(Q,{block:e.snapshot})),{name:M,body:K,choices:J,startDate:X,startTime:W,endDate:U,endTime:G,snapshot:$}=e,ee=((e,t)=>{const{name:n,body:c,choices:a,startDate:r,startTime:s,endDate:o,endTime:i,snapshot:l}=e,b={};n||(b.name=[t("%field% is required",{field:"Title"})]),c||(b.body=[t("%field% is required",{field:"Body"})]),a.length<2&&(b.choices=[t("Please create a minimum of %num% choices",{num:2})]);const d=a.some((e=>!e.value));2===a.length&&d&&(b.choices=Array.isArray(b.choices)?[...b.choices,t("Choices must not be empty")]:b.choices=[t("Choices must not be empty")]),Object(N.default)(r)||(b.startDate=[t("Please select a valid date")]),Object(N.default)(s)||(b.startTime=[t("Please select a valid time")]),Object(N.default)(o)||(b.endDate=[t("Please select a valid date")]),Object(N.default)(i)||(b.endTime=[t("Please select a valid time")]);const j=R(r,s);return R(o,i)<j&&(b.endDate=Array.isArray(b.endDate)?[...b.endDate,t("End date must be after the start date")]:b.endDate=[t("End date must be after the start date")]),0===l&&(b.snapshot=[t("Invalid snapshot")]),b})(e,b),te=(e,n)=>{t((t=>({...t,[e]:n}))),r((t=>({...t,[e]:!0})))},ne=e=>t=>{te(e,t)},ce=Object(s.useMemo)((()=>({hideIcons:j===q.a?[]:["guide","fullscreen","preview","side-by-side","image"]})),[j]);return Object(s.useEffect)((()=>{D>0&&t((e=>({...e,snapshot:D})))}),[D,t]),Object(A.jsxs)(v.a,{py:"40px",children:[Object(A.jsx)(o.n,{mb:"48px",children:Object(A.jsxs)(o.o,{children:[Object(A.jsx)(C.a,{to:"/",children:b("Home")}),Object(A.jsx)(C.a,{to:"/voting",children:b("Voting")}),Object(A.jsx)(o.Zb,{children:b("Make a Proposal")})]})}),Object(A.jsx)("form",{onSubmit:async e=>{e.preventDefault();try{c(!0);const e=JSON.stringify({...Object(T.e)(),type:x.f.PROPOSAL,payload:{name:M,body:K,snapshot:$,start:R(X,W),end:R(U,G),choices:J.filter((e=>e.value)).map((e=>e.value)),metadata:Object(T.d)(),type:"single-choice"}}),t=await Object(g.c)(E,j,e);if(t){const n={address:j,msg:e,sig:t},c=await Object(T.i)(n);P("/voting/proposal/".concat(c.ipfsHash)),V(b("Proposal created!"))}else L(b("Error"),b("Unable to sign payload"))}catch(t){L(b("Error"),(null===t||void 0===t?void 0:t.message)||(null===t||void 0===t?void 0:t.error)),console.error(t),c(!1)}},children:Object(A.jsxs)(S.a,{children:[Object(A.jsxs)(o.n,{children:[Object(A.jsxs)(o.n,{mb:"24px",children:[Object(A.jsx)(Z,{htmlFor:"name",children:b("Title")}),Object(A.jsx)(o.db,{id:"name",name:"name",value:M,scale:"lg",onChange:e=>{const{name:t,value:n}=e.currentTarget;te(t,n)},required:!0}),ee.name&&a.name&&Object(A.jsx)(z,{errors:ee.name})]}),Object(A.jsxs)(o.n,{mb:"24px",children:[Object(A.jsx)(Z,{htmlFor:"body",children:b("Content")}),Object(A.jsx)(o.Zb,{color:"textSubtle",mb:"8px",children:b("Tip: write in Markdown!")}),Object(A.jsx)(_,{id:"body",name:"body",onTextChange:e=>{te("body",e)},value:K,options:ce,required:!0}),ee.body&&a.body&&Object(A.jsx)(z,{errors:ee.body})]}),K&&Object(A.jsx)(o.n,{mb:"24px",children:Object(A.jsxs)(o.v,{children:[Object(A.jsx)(o.y,{children:Object(A.jsx)(o.X,{as:"h3",scale:"md",children:b("Preview")})}),Object(A.jsx)(o.w,{p:"0",px:"24px",children:Object(A.jsx)(B.a,{children:K})})]})}),Object(A.jsx)(H,{choices:J,onChange:e=>{te("choices",e)}}),ee.choices&&a.choices&&Object(A.jsx)(z,{errors:ee.choices})]}),Object(A.jsx)(o.n,{children:Object(A.jsxs)(o.v,{children:[Object(A.jsx)(o.y,{children:Object(A.jsx)(o.X,{as:"h3",scale:"md",children:b("Actions")})}),Object(A.jsxs)(o.w,{children:[Object(A.jsxs)(o.n,{mb:"24px",children:[Object(A.jsx)(I,{children:b("Start Date")}),Object(A.jsx)(w.a,{name:"startDate",onChange:ne("startDate"),selected:X,placeholderText:"YYYY/MM/DD"}),ee.startDate&&a.startDate&&Object(A.jsx)(z,{errors:ee.startDate})]}),Object(A.jsxs)(o.n,{mb:"24px",children:[Object(A.jsx)(I,{children:b("Start Time")}),Object(A.jsx)(w.c,{name:"startTime",onChange:ne("startTime"),selected:W,placeholderText:"00:00"}),ee.startTime&&a.startTime&&Object(A.jsx)(z,{errors:ee.startTime})]}),Object(A.jsxs)(o.n,{mb:"24px",children:[Object(A.jsx)(I,{children:b("End Date")}),Object(A.jsx)(w.a,{name:"endDate",onChange:ne("endDate"),selected:U,placeholderText:"YYYY/MM/DD"}),ee.endDate&&a.endDate&&Object(A.jsx)(z,{errors:ee.endDate})]}),Object(A.jsxs)(o.n,{mb:"24px",children:[Object(A.jsx)(I,{children:b("End Time")}),Object(A.jsx)(w.c,{name:"endTime",onChange:ne("endTime"),selected:G,placeholderText:"00:00"}),ee.endTime&&a.endTime&&Object(A.jsx)(z,{errors:ee.endTime})]}),j&&Object(A.jsxs)(o.V,{alignItems:"center",mb:"8px",children:[Object(A.jsx)(o.Zb,{color:"textSubtle",mr:"16px",children:b("Creator")}),Object(A.jsx)(o.hb,{href:Object(O.e)(j,"address"),children:Object(f.a)(j)})]}),Object(A.jsxs)(o.V,{alignItems:"center",mb:"16px",children:[Object(A.jsx)(o.Zb,{color:"textSubtle",mr:"16px",children:b("Snapshot")}),Object(A.jsx)(o.hb,{href:Object(O.e)($,"block"),children:$})]}),j?Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(o.r,{type:"submit",width:"100%",isLoading:n,endIcon:n?Object(A.jsx)(o.h,{spin:!0,color:"currentColor"}):null,disabled:!u()(ee),mb:"16px",children:b("Publish")}),Object(A.jsxs)(o.Zb,{color:"failure",as:"p",mb:"4px",children:[b("You need at least %count% voting power to publish a proposal.",{count:q.f})," "]}),Object(A.jsx)(o.r,{scale:"sm",type:"button",variant:"text",onClick:F,p:0,children:b("Check voting power")})]}):Object(A.jsx)(k.a,{width:"100%",type:"button"})]})]})})]})})]})}},744:function(e,t,n){"use strict";n.d(t,"h",(function(){return d})),n.d(t,"c",(function(){return j})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return x})),n.d(t,"i",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"a",(function(){return O})),n.d(t,"f",(function(){return f}));var c=n(11),a=n.n(c),r=n(15),s=n(84),o=n(23),i=n(50),l=n(82),b=n(746);const d=e=>e.author.toLowerCase()===b.a.toLowerCase(),j=(e,t)=>{switch(t){case i.e.COMMUNITY:return e.filter((e=>!d(e)));case i.e.CORE:return e.filter((e=>d(e)));case i.e.ALL:default:return e}},u=(e,t)=>e.filter((e=>e.state===t)),h=()=>({plugins:{},network:56,strategies:[{name:"cake",params:{symbol:"CAKE",address:Object(r.f)(),decimals:18}}]}),x=()=>({version:b.e,timestamp:(Date.now()/1e3).toFixed(),space:b.c}),p=async e=>{const t=await fetch(s.e,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(null===e||void 0===e?void 0:e.error_description)}return await t.json()},m=async(e,t,n)=>{const c=n||await l.a.getBlockNumber(),a=await fetch("".concat(s.f,"/power"),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({address:e,block:c,poolAddresses:t})});return(await a.json()).data},O=e=>e.reduce(((e,t)=>{const n=t.proposal.choices[t.choice-1];return{...e,[n]:e[n]?[...e[n],t]:[t]}}),{}),f=e=>e.reduce(((e,t)=>{var n;const c=new a.a(null===(n=t.metadata)||void 0===n?void 0:n.votingPower);return e.plus(c)}),o.d)},746:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return i}));const c=10,a="0x2096aFDaA68EEaE1EbF95DFdf565eE6d9B1fbA37",r="https://gateway.ipfs.io/ipfs",s="0.1.3",o="cake.eth",i=10},756:function(e,t,n){"use strict";t.a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return"".concat(e.substring(0,t),"...").concat(e.substring(e.length-n))}},802:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return l}));var c,a=n(7),r=(n(0),n(2)),s=n(4),o=n(1);const i=s.e.div(c||(c=Object(a.a)(["\n  align-items: center;\n  border: 1px solid ",";\n  border-radius: 12px;\n  display: flex;\n  height: 64px;\n  justify-content: space-between;\n  margin-bottom: 24px;\n  padding: 0 16px;\n"])),(e=>{let{theme:t}=e;return t.colors.cardBorder})),l=e=>Object(o.jsx)(r.n,{mb:"24px",maxWidth:"320px",...e})},814:function(e,t,n){"use strict";var c,a=n(7),r=n(69),s=n(4);const o=Object(s.e)(r.a)(c||(c=Object(a.a)(["\n  color: ",";\n"])),(e=>{let{theme:t}=e;return t.colors.primaryBright}));t.a=o},826:function(e,t,n){"use strict";var c,a=n(7);const r=n(4).e.div(c||(c=Object(a.a)(["\n  align-items: start;\n  display: grid;\n  grid-gap: 32px;\n  grid-template-columns: minmax(0, 1fr);\n\n  "," {\n    grid-template-columns: 1fr 332px;\n  }\n"])),(e=>{let{theme:t}=e;return t.mediaQueries.lg}));t.a=r},827:function(e,t,n){"use strict";n(0);var c=n(2),a=n(9),r=n(802),s=n(1);t.a=e=>{let{total:t,cakeBalance:n,cakeVaultBalance:o,cakePoolBalance:i,poolsBalance:l,cakeBnbLpBalance:b}=e;const{t:d}=Object(a.b)();return Object(s.jsxs)(r.a,{mb:"0",children:[Object(s.jsx)(c.Zb,{as:"p",mb:"24px",fontSize:"14px",color:"textSubtle",children:d("Your voting power is determined by the amount of CAKE you held at the block detailed below. CAKE held in other places does not contribute to your voting power.")}),Object(s.jsx)(c.Zb,{color:"secondary",textTransform:"uppercase",mb:"4px",bold:!0,fontSize:"14px",children:d("Overview")}),Object(s.jsxs)(r.b,{children:[Object(s.jsx)(c.Zb,{color:"secondary",children:d("Your Voting Power")}),Object(s.jsx)(c.Zb,{bold:!0,fontSize:"20px",children:t.toFormat(3)})]}),Object(s.jsx)(c.Zb,{color:"secondary",textTransform:"uppercase",mb:"4px",bold:!0,fontSize:"14px",children:d("Your Cake Held Now")}),Object(s.jsxs)(c.V,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Zb,{color:"textSubtle",fontSize:"16px",children:d("Wallet")}),Object(s.jsx)(c.Zb,{textAlign:"right",children:n.toFormat(3)})]}),Object(s.jsxs)(c.V,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Zb,{color:"textSubtle",fontSize:"16px",children:d("Manual CAKE Pool")}),Object(s.jsx)(c.Zb,{textAlign:"right",children:i.toFormat(3)})]}),Object(s.jsxs)(c.V,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Zb,{color:"textSubtle",fontSize:"16px",children:d("Auto CAKE Pool")}),Object(s.jsx)(c.Zb,{textAlign:"right",children:o.toFormat(3)})]}),Object(s.jsxs)(c.V,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Zb,{color:"textSubtle",fontSize:"16px",children:d("Other Syrup Pools")}),Object(s.jsx)(c.Zb,{textAlign:"right",children:l.toFormat(3)})]}),Object(s.jsxs)(c.V,{alignItems:"center",justifyContent:"space-between",mb:"4px",children:[Object(s.jsx)(c.Zb,{color:"textSubtle",fontSize:"16px",children:d("CAKE BNB LP")}),Object(s.jsx)(c.Zb,{textAlign:"right",children:b.toFormat(3)})]})]})}},828:function(e,t,n){"use strict";var c=n(0),a=n(35),r=n(23),s=n(163),o=n(15),i=n(82),l=n(11),b=n.n(l),d=n(744);const j={verificationHash:null,cakeBalance:r.d,cakeVaultBalance:r.d,cakePoolBalance:r.d,poolsBalance:r.d,cakeBnbLpBalance:r.d,total:r.d};t.a=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{account:n}=Object(a.c)(),[r,l]=Object(c.useState)(j),[u,h]=Object(c.useState)(!!n);return Object(c.useEffect)((()=>{n&&t&&(async()=>{h(!0);try{const c=e||await i.a.getBlockNumber(),a=(await Object(s.b)(c)).map((e=>{let{contractAddress:t}=e;return Object(o.a)(t)})),{cakeBalance:r,cakeBnbLpBalance:j,cakePoolBalance:u,total:x,poolsBalance:p,cakeVaultBalance:m,verificationHash:O}=await Object(d.g)(n,a,c);t&&l((e=>({...e,verificationHash:O,cakeBalance:new b.a(r),cakeBnbLpBalance:new b.a(j),cakePoolBalance:new b.a(u),poolsBalance:new b.a(p),cakeVaultBalance:new b.a(m),total:new b.a(x)})))}finally{h(!1)}})()}),[n,e,l,t,h]),{...r,isLoading:u}}},869:function(e,t,n){"use strict";n(0);var c,a,r,s=n(872),o=n.n(s),i=n(908),l=n.n(i),b=n(7),d=n(2),j=n(4),u=n(1);const h=j.e.table(c||(c=Object(b.a)(["\n  margin-bottom: 32px;\n  margin-top: 32px;\n  width: 100%;\n\n  td,\n  th {\n    color: ",";\n    padding: 8px;\n  }\n"])),(e=>{let{theme:t}=e;return t.colors.text})),x=j.e.div(a||(a=Object(b.a)(["\n  color: ",";\n  margin-bottom: 16px;\n  margin-top: 16px;\n\n  li {\n    margin-bottom: 8px;\n  }\n"])),(e=>{let{theme:t}=e;return t.colors.text})),p=e=>Object(u.jsx)(d.X,{as:"h4",scale:"lg",my:"16px",...e});var m={h1:p,h2:p,h3:p,h4:p,h5:p,h6:p,p:e=>Object(u.jsx)(d.Zb,{as:"p",my:"16px",...e}),table:h,ol:e=>Object(u.jsx)(x,{as:"ol",...e}),ul:e=>Object(u.jsx)(x,{as:"ul",...e}),pre:j.e.pre(r||(r=Object(b.a)(["\n  color: ",";\n  margin-bottom: 16px;\n  margin-top: 16px;\n  max-width: 100%;\n  overflow-x: auto;\n"])),(e=>{let{theme:t}=e;return t.colors.text}))};t.a=e=>Object(u.jsx)(o.a,{remarkPlugins:[l.a],components:m,...e})}}]);
//# sourceMappingURL=9.14e3b84f.chunk.js.map