{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Devrim\\\\Documents\\\\FRANKswapUIforProspBlast\\\\src\\\\views\\\\Predictions\\\\components\\\\History\\\\PnlTab\\\\PnlTab.tsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport styled from 'styled-components';\nimport { useWeb3React } from '@web3-react/core';\nimport { Box, Flex, Heading, Text, Button, Link, OpenNewIcon } from '@pancakeswap/uikit';\nimport { useTranslation } from 'contexts/Localization';\nimport { getRoundResult, Result } from 'state/predictions/helpers';\nimport { getBscScanLink } from 'utils';\nimport store from 'state';\nimport { useGetCurrentEpoch } from 'state/hooks';\nimport { usePriceBnbBusd } from 'state/farms/hooks';\nimport { BetPosition } from 'state/types';\nimport { formatBnb, getMultiplier, getNetPayout } from '../helpers';\nimport PnlChart from './PnlChart';\nimport SummaryRow from './SummaryRow';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Divider = styled.div`\n  background-color: ${({\n  theme\n}) => theme.colors.backgroundDisabled};\n  height: 1px;\n  margin: 24px auto;\n  width: 100%;\n`;\n_c = Divider;\nconst initialPnlSummary = {\n  won: {\n    rounds: 0,\n    amount: 0,\n    payout: 0,\n    // net payout after all deductions\n    bestRound: {\n      id: '0',\n      payout: 0,\n      // net payout after all deductions\n      multiplier: 0\n    }\n  },\n  lost: {\n    rounds: 0,\n    amount: 0\n  },\n  entered: {\n    rounds: 0,\n    amount: 0\n  }\n};\n\nconst getPnlSummary = (bets, currentEpoch) => {\n  const state = store.getState();\n  const rewardRate = state.predictions.rewardRate / 100;\n  return bets.reduce((summary, bet) => {\n    const roundResult = getRoundResult(bet, currentEpoch);\n\n    if (roundResult === Result.WIN) {\n      const payout = getNetPayout(bet, rewardRate);\n      let {\n        bestRound\n      } = summary.won;\n\n      if (payout > bestRound.payout) {\n        const {\n          bullAmount,\n          bearAmount,\n          totalAmount\n        } = bet.round;\n        const multiplier = getMultiplier(totalAmount, bet.position === BetPosition.BULL ? bullAmount : bearAmount);\n        bestRound = {\n          id: bet.round.id,\n          payout,\n          multiplier\n        };\n      }\n\n      return {\n        won: {\n          rounds: summary.won.rounds + 1,\n          amount: summary.won.amount + bet.amount,\n          payout: summary.won.payout + payout,\n          bestRound\n        },\n        entered: {\n          rounds: summary.entered.rounds + 1,\n          amount: summary.entered.amount + bet.amount\n        },\n        lost: summary.lost\n      };\n    }\n\n    if (roundResult === Result.LOSE) {\n      return {\n        lost: {\n          rounds: summary.lost.rounds + 1,\n          amount: summary.lost.amount + bet.amount\n        },\n        entered: {\n          rounds: summary.entered.rounds + 1,\n          amount: summary.entered.amount + bet.amount\n        },\n        won: summary.won\n      };\n    } // Ignore Canceled and Live rounds\n\n\n    return summary;\n  }, initialPnlSummary);\n};\n\nconst PnlTab = ({\n  hasBetHistory,\n  bets\n}) => {\n  _s();\n\n  const {\n    t\n  } = useTranslation();\n  const {\n    account\n  } = useWeb3React();\n  const currentEpoch = useGetCurrentEpoch();\n  const bnbBusdPrice = usePriceBnbBusd();\n  const summary = getPnlSummary(bets, currentEpoch);\n  const netResultAmount = summary.won.payout - summary.lost.amount;\n  const netResultIsPositive = netResultAmount > 0;\n  const avgPositionEntered = summary.entered.amount / summary.entered.rounds;\n  const avgBnbWonPerRound = netResultAmount / summary.entered.rounds;\n  const avgBnbWonIsPositive = avgBnbWonPerRound > 0; // Guard in case user has only lost rounds\n\n  const hasBestRound = summary.won.bestRound.payout !== 0;\n  return hasBetHistory ? /*#__PURE__*/_jsxDEV(Box, {\n    p: \"16px\",\n    children: [/*#__PURE__*/_jsxDEV(Text, {\n      bold: true,\n      fontSize: \"24px\",\n      color: \"secondary\",\n      pb: \"24px\",\n      children: t('Your history')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Flex, {\n      children: [/*#__PURE__*/_jsxDEV(PnlChart, {\n        lost: summary.lost.rounds,\n        won: summary.won.rounds\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Flex, {\n        flexDirection: \"column\",\n        justifyContent: \"center\",\n        pl: \"24px\",\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          bold: true,\n          color: \"textSubtle\",\n          children: t('Net results')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Text, {\n          bold: true,\n          fontSize: \"24px\",\n          lineHeight: \"1\",\n          color: netResultIsPositive ? 'success' : 'failure',\n          children: `${netResultIsPositive ? '+' : ''}${formatBnb(netResultAmount)} BNB`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Text, {\n          small: true,\n          color: \"textSubtle\",\n          children: `~$${formatBnb(bnbBusdPrice.times(netResultAmount).toNumber())}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      pl: \"8px\",\n      children: [/*#__PURE__*/_jsxDEV(Text, {\n        mt: \"24px\",\n        bold: true,\n        color: \"textSubtle\",\n        children: t('Average return / round')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        bold: true,\n        color: avgBnbWonIsPositive ? 'success' : 'failure',\n        children: `${avgBnbWonIsPositive ? '+' : ''}${formatBnb(avgBnbWonPerRound)} BNB`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        small: true,\n        color: \"textSubtle\",\n        children: `~$${formatBnb(bnbBusdPrice.times(avgBnbWonPerRound).toNumber())}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this), hasBestRound && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Text, {\n          mt: \"16px\",\n          bold: true,\n          color: \"textSubtle\",\n          children: t('Best round: #%roundId%', {\n            roundId: summary.won.bestRound.id\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Flex, {\n          alignItems: \"flex-end\",\n          children: [/*#__PURE__*/_jsxDEV(Text, {\n            bold: true,\n            color: \"success\",\n            children: `+${formatBnb(summary.won.bestRound.payout)} BNB`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Text, {\n            ml: \"4px\",\n            small: true,\n            color: \"textSubtle\",\n            children: [\"(\", summary.won.bestRound.multiplier.toFixed(2), \"x)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Text, {\n          small: true,\n          color: \"textSubtle\",\n          children: `~$${formatBnb(bnbBusdPrice.times(summary.won.bestRound.payout).toNumber())}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), /*#__PURE__*/_jsxDEV(Text, {\n        mt: \"16px\",\n        bold: true,\n        color: \"textSubtle\",\n        children: t('Average position entered / round')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        bold: true,\n        children: `${formatBnb(avgPositionEntered)} BNB`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Text, {\n        small: true,\n        color: \"textSubtle\",\n        children: `~$${formatBnb(bnbBusdPrice.times(avgPositionEntered).toNumber())}`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SummaryRow, {\n        type: \"won\",\n        summary: summary,\n        bnbBusdPrice: bnbBusdPrice\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SummaryRow, {\n        type: \"lost\",\n        summary: summary,\n        bnbBusdPrice: bnbBusdPrice\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(SummaryRow, {\n        type: \"entered\",\n        summary: summary,\n        bnbBusdPrice: bnbBusdPrice\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Flex, {\n        justifyContent: \"center\",\n        mt: \"24px\",\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: `${getBscScanLink(account, 'address')}#internaltx`,\n          mb: \"16px\",\n          external: true,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            mt: \"8px\",\n            width: \"100%\",\n            children: [t('View Reclaimed & Won'), /*#__PURE__*/_jsxDEV(OpenNewIcon, {\n              color: \"white\",\n              ml: \"4px\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(Box, {\n    p: \"24px\",\n    children: [/*#__PURE__*/_jsxDEV(Heading, {\n      size: \"lg\",\n      textAlign: \"center\",\n      mb: \"8px\",\n      children: t('No prediction history available')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Text, {\n      as: \"p\",\n      textAlign: \"center\",\n      children: t('If you are sure you should see history here, make sure you’re connected to the correct wallet and try again.')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 194,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PnlTab, \"sujD/1N7CFw5NtBq6tQW4VwkhlY=\", false, function () {\n  return [useTranslation, useWeb3React, useGetCurrentEpoch, usePriceBnbBusd];\n});\n\n_c2 = PnlTab;\nexport default PnlTab;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Divider\");\n$RefreshReg$(_c2, \"PnlTab\");","map":{"version":3,"sources":["C:/Users/Devrim/Documents/FRANKswapUIforProspBlast/src/views/Predictions/components/History/PnlTab/PnlTab.tsx"],"names":["React","styled","useWeb3React","Box","Flex","Heading","Text","Button","Link","OpenNewIcon","useTranslation","getRoundResult","Result","getBscScanLink","store","useGetCurrentEpoch","usePriceBnbBusd","BetPosition","formatBnb","getMultiplier","getNetPayout","PnlChart","SummaryRow","Divider","div","theme","colors","backgroundDisabled","initialPnlSummary","won","rounds","amount","payout","bestRound","id","multiplier","lost","entered","getPnlSummary","bets","currentEpoch","state","getState","rewardRate","predictions","reduce","summary","bet","roundResult","WIN","bullAmount","bearAmount","totalAmount","round","position","BULL","LOSE","PnlTab","hasBetHistory","t","account","bnbBusdPrice","netResultAmount","netResultIsPositive","avgPositionEntered","avgBnbWonPerRound","avgBnbWonIsPositive","hasBestRound","times","toNumber","roundId","toFixed"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport styled from 'styled-components'\r\nimport { useWeb3React } from '@web3-react/core'\r\nimport { Box, Flex, Heading, Text, Button, Link, OpenNewIcon } from '@pancakeswap/uikit'\r\nimport { useTranslation } from 'contexts/Localization'\r\nimport { getRoundResult, Result } from 'state/predictions/helpers'\r\nimport { getBscScanLink } from 'utils'\r\nimport store from 'state'\r\nimport { useGetCurrentEpoch } from 'state/hooks'\r\nimport { usePriceBnbBusd } from 'state/farms/hooks'\r\nimport { Bet, BetPosition } from 'state/types'\r\nimport { formatBnb, getMultiplier, getNetPayout } from '../helpers'\r\nimport PnlChart from './PnlChart'\r\nimport SummaryRow from './SummaryRow'\r\n\r\ninterface PnlTabProps {\r\n  hasBetHistory: boolean\r\n  bets: Bet[]\r\n}\r\n\r\ninterface PnlCategory {\r\n  rounds: number\r\n  amount: number\r\n}\r\n\r\ninterface PnlSummary {\r\n  won: PnlCategory & { payout: number; bestRound: { id: string; payout: number; multiplier: number } }\r\n  lost: PnlCategory\r\n  entered: PnlCategory\r\n}\r\n\r\nconst Divider = styled.div`\r\n  background-color: ${({ theme }) => theme.colors.backgroundDisabled};\r\n  height: 1px;\r\n  margin: 24px auto;\r\n  width: 100%;\r\n`\r\n\r\nconst initialPnlSummary: PnlSummary = {\r\n  won: {\r\n    rounds: 0,\r\n    amount: 0,\r\n    payout: 0, // net payout after all deductions\r\n    bestRound: {\r\n      id: '0',\r\n      payout: 0, // net payout after all deductions\r\n      multiplier: 0,\r\n    },\r\n  },\r\n  lost: {\r\n    rounds: 0,\r\n    amount: 0,\r\n  },\r\n  entered: {\r\n    rounds: 0,\r\n    amount: 0,\r\n  },\r\n}\r\n\r\nconst getPnlSummary = (bets: Bet[], currentEpoch: number): PnlSummary => {\r\n  const state = store.getState()\r\n  const rewardRate = state.predictions.rewardRate / 100\r\n\r\n  return bets.reduce((summary: PnlSummary, bet) => {\r\n    const roundResult = getRoundResult(bet, currentEpoch)\r\n    if (roundResult === Result.WIN) {\r\n      const payout = getNetPayout(bet, rewardRate)\r\n      let { bestRound } = summary.won\r\n      if (payout > bestRound.payout) {\r\n        const { bullAmount, bearAmount, totalAmount } = bet.round\r\n        const multiplier = getMultiplier(totalAmount, bet.position === BetPosition.BULL ? bullAmount : bearAmount)\r\n        bestRound = { id: bet.round.id, payout, multiplier }\r\n      }\r\n      return {\r\n        won: {\r\n          rounds: summary.won.rounds + 1,\r\n          amount: summary.won.amount + bet.amount,\r\n          payout: summary.won.payout + payout,\r\n          bestRound,\r\n        },\r\n        entered: {\r\n          rounds: summary.entered.rounds + 1,\r\n          amount: summary.entered.amount + bet.amount,\r\n        },\r\n        lost: summary.lost,\r\n      }\r\n    }\r\n    if (roundResult === Result.LOSE) {\r\n      return {\r\n        lost: {\r\n          rounds: summary.lost.rounds + 1,\r\n          amount: summary.lost.amount + bet.amount,\r\n        },\r\n        entered: {\r\n          rounds: summary.entered.rounds + 1,\r\n          amount: summary.entered.amount + bet.amount,\r\n        },\r\n        won: summary.won,\r\n      }\r\n    }\r\n    // Ignore Canceled and Live rounds\r\n    return summary\r\n  }, initialPnlSummary)\r\n}\r\n\r\nconst PnlTab: React.FC<PnlTabProps> = ({ hasBetHistory, bets }) => {\r\n  const { t } = useTranslation()\r\n  const { account } = useWeb3React()\r\n  const currentEpoch = useGetCurrentEpoch()\r\n  const bnbBusdPrice = usePriceBnbBusd()\r\n\r\n  const summary = getPnlSummary(bets, currentEpoch)\r\n  const netResultAmount = summary.won.payout - summary.lost.amount\r\n  const netResultIsPositive = netResultAmount > 0\r\n  const avgPositionEntered = summary.entered.amount / summary.entered.rounds\r\n  const avgBnbWonPerRound = netResultAmount / summary.entered.rounds\r\n  const avgBnbWonIsPositive = avgBnbWonPerRound > 0\r\n\r\n  // Guard in case user has only lost rounds\r\n  const hasBestRound = summary.won.bestRound.payout !== 0\r\n\r\n  return hasBetHistory ? (\r\n    <Box p=\"16px\">\r\n      <Text bold fontSize=\"24px\" color=\"secondary\" pb=\"24px\">\r\n        {t('Your history')}\r\n      </Text>\r\n      <Flex>\r\n        <PnlChart lost={summary.lost.rounds} won={summary.won.rounds} />\r\n        <Flex flexDirection=\"column\" justifyContent=\"center\" pl=\"24px\">\r\n          <Text bold color=\"textSubtle\">\r\n            {t('Net results')}\r\n          </Text>\r\n          <Text bold fontSize=\"24px\" lineHeight=\"1\" color={netResultIsPositive ? 'success' : 'failure'}>\r\n            {`${netResultIsPositive ? '+' : ''}${formatBnb(netResultAmount)} BNB`}\r\n          </Text>\r\n          <Text small color=\"textSubtle\">\r\n            {`~$${formatBnb(bnbBusdPrice.times(netResultAmount).toNumber())}`}\r\n          </Text>\r\n        </Flex>\r\n      </Flex>\r\n      <Box pl=\"8px\">\r\n        <Text mt=\"24px\" bold color=\"textSubtle\">\r\n          {t('Average return / round')}\r\n        </Text>\r\n        <Text bold color={avgBnbWonIsPositive ? 'success' : 'failure'}>\r\n          {`${avgBnbWonIsPositive ? '+' : ''}${formatBnb(avgBnbWonPerRound)} BNB`}\r\n        </Text>\r\n        <Text small color=\"textSubtle\">\r\n          {`~$${formatBnb(bnbBusdPrice.times(avgBnbWonPerRound).toNumber())}`}\r\n        </Text>\r\n\r\n        {hasBestRound && (\r\n          <>\r\n            <Text mt=\"16px\" bold color=\"textSubtle\">\r\n              {t('Best round: #%roundId%', { roundId: summary.won.bestRound.id })}\r\n            </Text>\r\n            <Flex alignItems=\"flex-end\">\r\n              <Text bold color=\"success\">{`+${formatBnb(summary.won.bestRound.payout)} BNB`}</Text>\r\n              <Text ml=\"4px\" small color=\"textSubtle\">\r\n                ({summary.won.bestRound.multiplier.toFixed(2)}x)\r\n              </Text>\r\n            </Flex>\r\n            <Text small color=\"textSubtle\">\r\n              {`~$${formatBnb(bnbBusdPrice.times(summary.won.bestRound.payout).toNumber())}`}\r\n            </Text>\r\n          </>\r\n        )}\r\n\r\n        <Text mt=\"16px\" bold color=\"textSubtle\">\r\n          {t('Average position entered / round')}\r\n        </Text>\r\n        <Text bold>{`${formatBnb(avgPositionEntered)} BNB`}</Text>\r\n        <Text small color=\"textSubtle\">\r\n          {`~$${formatBnb(bnbBusdPrice.times(avgPositionEntered).toNumber())}`}\r\n        </Text>\r\n\r\n        <Divider />\r\n\r\n        <SummaryRow type=\"won\" summary={summary} bnbBusdPrice={bnbBusdPrice} />\r\n        <SummaryRow type=\"lost\" summary={summary} bnbBusdPrice={bnbBusdPrice} />\r\n        <SummaryRow type=\"entered\" summary={summary} bnbBusdPrice={bnbBusdPrice} />\r\n\r\n        <Flex justifyContent=\"center\" mt=\"24px\">\r\n          <Link href={`${getBscScanLink(account, 'address')}#internaltx`} mb=\"16px\" external>\r\n            <Button mt=\"8px\" width=\"100%\">\r\n              {t('View Reclaimed & Won')}\r\n              <OpenNewIcon color=\"white\" ml=\"4px\" />\r\n            </Button>\r\n          </Link>\r\n        </Flex>\r\n      </Box>\r\n    </Box>\r\n  ) : (\r\n    <Box p=\"24px\">\r\n      <Heading size=\"lg\" textAlign=\"center\" mb=\"8px\">\r\n        {t('No prediction history available')}\r\n      </Heading>\r\n      <Text as=\"p\" textAlign=\"center\">\r\n        {t(\r\n          'If you are sure you should see history here, make sure you’re connected to the correct wallet and try again.',\r\n        )}\r\n      </Text>\r\n    </Box>\r\n  )\r\n}\r\n\r\nexport default PnlTab\r\n"]},"metadata":{},"sourceType":"module"}