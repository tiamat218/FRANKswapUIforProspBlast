{"ast":null,"code":"import{createReducer}from'@reduxjs/toolkit';import{INITIAL_ALLOWED_SLIPPAGE,DEFAULT_DEADLINE_FROM_NOW}from'../../config/constants';import{updateVersion}from'../global/actions';import{addSerializedPair,addSerializedToken,removeSerializedPair,removeSerializedToken,updateUserExpertMode,updateUserSlippageTolerance,updateUserDeadline,updateUserSingleHopOnly,muteAudio,unmuteAudio,toggleTheme}from'./actions';const currentTimestamp=()=>new Date().getTime();function pairKey(token0Address,token1Address){return\"\".concat(token0Address,\";\").concat(token1Address);}export const initialState={userExpertMode:false,userSingleHopOnly:false,userSlippageTolerance:INITIAL_ALLOWED_SLIPPAGE,userDeadline:DEFAULT_DEADLINE_FROM_NOW,tokens:{},pairs:{},timestamp:currentTimestamp(),audioPlay:true,isDark:false};export default createReducer(initialState,builder=>builder.addCase(updateVersion,state=>{// slippage isnt being tracked in local storage, reset to default\n// noinspection SuspiciousTypeOfGuard\nif(typeof state.userSlippageTolerance!=='number'){state.userSlippageTolerance=INITIAL_ALLOWED_SLIPPAGE;}// deadline isnt being tracked in local storage, reset to default\n// noinspection SuspiciousTypeOfGuard\nif(typeof state.userDeadline!=='number'){state.userDeadline=DEFAULT_DEADLINE_FROM_NOW;}state.lastUpdateVersionTimestamp=currentTimestamp();}).addCase(updateUserExpertMode,(state,action)=>{state.userExpertMode=action.payload.userExpertMode;state.timestamp=currentTimestamp();}).addCase(updateUserSlippageTolerance,(state,action)=>{state.userSlippageTolerance=action.payload.userSlippageTolerance;state.timestamp=currentTimestamp();}).addCase(updateUserDeadline,(state,action)=>{state.userDeadline=action.payload.userDeadline;state.timestamp=currentTimestamp();}).addCase(updateUserSingleHopOnly,(state,action)=>{state.userSingleHopOnly=action.payload.userSingleHopOnly;}).addCase(addSerializedToken,(state,_ref)=>{let{payload:{serializedToken}}=_ref;if(!state.tokens){state.tokens={};}state.tokens[serializedToken.chainId]=state.tokens[serializedToken.chainId]||{};state.tokens[serializedToken.chainId][serializedToken.address]=serializedToken;state.timestamp=currentTimestamp();}).addCase(removeSerializedToken,(state,_ref2)=>{let{payload:{address,chainId}}=_ref2;if(!state.tokens){state.tokens={};}state.tokens[chainId]=state.tokens[chainId]||{};delete state.tokens[chainId][address];state.timestamp=currentTimestamp();}).addCase(addSerializedPair,(state,_ref3)=>{let{payload:{serializedPair}}=_ref3;if(serializedPair.token0.chainId===serializedPair.token1.chainId&&serializedPair.token0.address!==serializedPair.token1.address){const{chainId}=serializedPair.token0;state.pairs[chainId]=state.pairs[chainId]||{};state.pairs[chainId][pairKey(serializedPair.token0.address,serializedPair.token1.address)]=serializedPair;}state.timestamp=currentTimestamp();}).addCase(removeSerializedPair,(state,_ref4)=>{let{payload:{chainId,tokenAAddress,tokenBAddress}}=_ref4;if(state.pairs[chainId]){// just delete both keys if either exists\ndelete state.pairs[chainId][pairKey(tokenAAddress,tokenBAddress)];delete state.pairs[chainId][pairKey(tokenBAddress,tokenAAddress)];}state.timestamp=currentTimestamp();}).addCase(muteAudio,state=>{state.audioPlay=false;}).addCase(unmuteAudio,state=>{state.audioPlay=true;}).addCase(toggleTheme,state=>{state.isDark=!state.isDark;}));","map":{"version":3,"names":["createReducer","INITIAL_ALLOWED_SLIPPAGE","DEFAULT_DEADLINE_FROM_NOW","updateVersion","addSerializedPair","addSerializedToken","removeSerializedPair","removeSerializedToken","updateUserExpertMode","updateUserSlippageTolerance","updateUserDeadline","updateUserSingleHopOnly","muteAudio","unmuteAudio","toggleTheme","currentTimestamp","Date","getTime","pairKey","token0Address","token1Address","concat","initialState","userExpertMode","userSingleHopOnly","userSlippageTolerance","userDeadline","tokens","pairs","timestamp","audioPlay","isDark","builder","addCase","state","lastUpdateVersionTimestamp","action","payload","_ref","serializedToken","chainId","address","_ref2","_ref3","serializedPair","token0","token1","_ref4","tokenAAddress","tokenBAddress"],"sources":["C:/Users/frkul/Documents/swapUI_pancake-frontend/src/state/user/reducer.ts"],"sourcesContent":["import { createReducer } from '@reduxjs/toolkit'\r\nimport { INITIAL_ALLOWED_SLIPPAGE, DEFAULT_DEADLINE_FROM_NOW } from '../../config/constants'\r\nimport { updateVersion } from '../global/actions'\r\nimport {\r\n  addSerializedPair,\r\n  addSerializedToken,\r\n  removeSerializedPair,\r\n  removeSerializedToken,\r\n  SerializedPair,\r\n  SerializedToken,\r\n  updateUserExpertMode,\r\n  updateUserSlippageTolerance,\r\n  updateUserDeadline,\r\n  updateUserSingleHopOnly,\r\n  muteAudio,\r\n  unmuteAudio,\r\n  toggleTheme,\r\n} from './actions'\r\n\r\nconst currentTimestamp = () => new Date().getTime()\r\n\r\nexport interface UserState {\r\n  // the timestamp of the last updateVersion action\r\n  lastUpdateVersionTimestamp?: number\r\n\r\n  userExpertMode: boolean\r\n\r\n  // only allow swaps on direct pairs\r\n  userSingleHopOnly: boolean\r\n\r\n  // user defined slippage tolerance in bips, used in all txns\r\n  userSlippageTolerance: number\r\n\r\n  // deadline set by user in minutes, used in all txns\r\n  userDeadline: number\r\n\r\n  tokens: {\r\n    [chainId: number]: {\r\n      [address: string]: SerializedToken\r\n    }\r\n  }\r\n\r\n  pairs: {\r\n    [chainId: number]: {\r\n      // keyed by token0Address:token1Address\r\n      [key: string]: SerializedPair\r\n    }\r\n  }\r\n\r\n  timestamp: number\r\n  audioPlay: boolean\r\n  isDark: boolean\r\n}\r\n\r\nfunction pairKey(token0Address: string, token1Address: string) {\r\n  return `${token0Address};${token1Address}`\r\n}\r\n\r\nexport const initialState: UserState = {\r\n  userExpertMode: false,\r\n  userSingleHopOnly: false,\r\n  userSlippageTolerance: INITIAL_ALLOWED_SLIPPAGE,\r\n  userDeadline: DEFAULT_DEADLINE_FROM_NOW,\r\n  tokens: {},\r\n  pairs: {},\r\n  timestamp: currentTimestamp(),\r\n  audioPlay: true,\r\n  isDark: false,\r\n}\r\n\r\nexport default createReducer(initialState, (builder) =>\r\n  builder\r\n    .addCase(updateVersion, (state) => {\r\n      // slippage isnt being tracked in local storage, reset to default\r\n      // noinspection SuspiciousTypeOfGuard\r\n      if (typeof state.userSlippageTolerance !== 'number') {\r\n        state.userSlippageTolerance = INITIAL_ALLOWED_SLIPPAGE\r\n      }\r\n\r\n      // deadline isnt being tracked in local storage, reset to default\r\n      // noinspection SuspiciousTypeOfGuard\r\n      if (typeof state.userDeadline !== 'number') {\r\n        state.userDeadline = DEFAULT_DEADLINE_FROM_NOW\r\n      }\r\n\r\n      state.lastUpdateVersionTimestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserExpertMode, (state, action) => {\r\n      state.userExpertMode = action.payload.userExpertMode\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserSlippageTolerance, (state, action) => {\r\n      state.userSlippageTolerance = action.payload.userSlippageTolerance\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserDeadline, (state, action) => {\r\n      state.userDeadline = action.payload.userDeadline\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(updateUserSingleHopOnly, (state, action) => {\r\n      state.userSingleHopOnly = action.payload.userSingleHopOnly\r\n    })\r\n    .addCase(addSerializedToken, (state, { payload: { serializedToken } }) => {\r\n      if (!state.tokens) {\r\n        state.tokens = {}\r\n      }\r\n      state.tokens[serializedToken.chainId] = state.tokens[serializedToken.chainId] || {}\r\n      state.tokens[serializedToken.chainId][serializedToken.address] = serializedToken\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(removeSerializedToken, (state, { payload: { address, chainId } }) => {\r\n      if (!state.tokens) {\r\n        state.tokens = {}\r\n      }\r\n      state.tokens[chainId] = state.tokens[chainId] || {}\r\n      delete state.tokens[chainId][address]\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(addSerializedPair, (state, { payload: { serializedPair } }) => {\r\n      if (\r\n        serializedPair.token0.chainId === serializedPair.token1.chainId &&\r\n        serializedPair.token0.address !== serializedPair.token1.address\r\n      ) {\r\n        const { chainId } = serializedPair.token0\r\n        state.pairs[chainId] = state.pairs[chainId] || {}\r\n        state.pairs[chainId][pairKey(serializedPair.token0.address, serializedPair.token1.address)] = serializedPair\r\n      }\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(removeSerializedPair, (state, { payload: { chainId, tokenAAddress, tokenBAddress } }) => {\r\n      if (state.pairs[chainId]) {\r\n        // just delete both keys if either exists\r\n        delete state.pairs[chainId][pairKey(tokenAAddress, tokenBAddress)]\r\n        delete state.pairs[chainId][pairKey(tokenBAddress, tokenAAddress)]\r\n      }\r\n      state.timestamp = currentTimestamp()\r\n    })\r\n    .addCase(muteAudio, (state) => {\r\n      state.audioPlay = false\r\n    })\r\n    .addCase(unmuteAudio, (state) => {\r\n      state.audioPlay = true\r\n    })\r\n    .addCase(toggleTheme, (state) => {\r\n      state.isDark = !state.isDark\r\n    }),\r\n)\r\n"],"mappings":"AAAA,OAASA,aAAa,KAAQ,kBAAkB,CAChD,OAASC,wBAAwB,CAAEC,yBAAyB,KAAQ,wBAAwB,CAC5F,OAASC,aAAa,KAAQ,mBAAmB,CACjD,OACEC,iBAAiB,CACjBC,kBAAkB,CAClBC,oBAAoB,CACpBC,qBAAqB,CAGrBC,oBAAoB,CACpBC,2BAA2B,CAC3BC,kBAAkB,CAClBC,uBAAuB,CACvBC,SAAS,CACTC,WAAW,CACXC,WAAW,KACN,WAAW,CAElB,KAAM,CAAAC,gBAAgB,CAAGA,CAAA,GAAM,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,OAAO,CAAC,CAAC,CAmCnD,QAAS,CAAAC,OAAOA,CAACC,aAAqB,CAAEC,aAAqB,CAAE,CAC7D,SAAAC,MAAA,CAAUF,aAAa,MAAAE,MAAA,CAAID,aAAa,EAC1C,CAEA,MAAO,MAAM,CAAAE,YAAuB,CAAG,CACrCC,cAAc,CAAE,KAAK,CACrBC,iBAAiB,CAAE,KAAK,CACxBC,qBAAqB,CAAExB,wBAAwB,CAC/CyB,YAAY,CAAExB,yBAAyB,CACvCyB,MAAM,CAAE,CAAC,CAAC,CACVC,KAAK,CAAE,CAAC,CAAC,CACTC,SAAS,CAAEd,gBAAgB,CAAC,CAAC,CAC7Be,SAAS,CAAE,IAAI,CACfC,MAAM,CAAE,KACV,CAAC,CAED,cAAe,CAAA/B,aAAa,CAACsB,YAAY,CAAGU,OAAO,EACjDA,OAAO,CACJC,OAAO,CAAC9B,aAAa,CAAG+B,KAAK,EAAK,CACjC;AACA;AACA,GAAI,MAAO,CAAAA,KAAK,CAACT,qBAAqB,GAAK,QAAQ,CAAE,CACnDS,KAAK,CAACT,qBAAqB,CAAGxB,wBAAwB,CACxD,CAEA;AACA;AACA,GAAI,MAAO,CAAAiC,KAAK,CAACR,YAAY,GAAK,QAAQ,CAAE,CAC1CQ,KAAK,CAACR,YAAY,CAAGxB,yBAAyB,CAChD,CAEAgC,KAAK,CAACC,0BAA0B,CAAGpB,gBAAgB,CAAC,CAAC,CACvD,CAAC,CAAC,CACDkB,OAAO,CAACzB,oBAAoB,CAAE,CAAC0B,KAAK,CAAEE,MAAM,GAAK,CAChDF,KAAK,CAACX,cAAc,CAAGa,MAAM,CAACC,OAAO,CAACd,cAAc,CACpDW,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAACxB,2BAA2B,CAAE,CAACyB,KAAK,CAAEE,MAAM,GAAK,CACvDF,KAAK,CAACT,qBAAqB,CAAGW,MAAM,CAACC,OAAO,CAACZ,qBAAqB,CAClES,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAACvB,kBAAkB,CAAE,CAACwB,KAAK,CAAEE,MAAM,GAAK,CAC9CF,KAAK,CAACR,YAAY,CAAGU,MAAM,CAACC,OAAO,CAACX,YAAY,CAChDQ,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAACtB,uBAAuB,CAAE,CAACuB,KAAK,CAAEE,MAAM,GAAK,CACnDF,KAAK,CAACV,iBAAiB,CAAGY,MAAM,CAACC,OAAO,CAACb,iBAAiB,CAC5D,CAAC,CAAC,CACDS,OAAO,CAAC5B,kBAAkB,CAAE,CAAC6B,KAAK,CAAAI,IAAA,GAAuC,IAArC,CAAED,OAAO,CAAE,CAAEE,eAAgB,CAAE,CAAC,CAAAD,IAAA,CACnE,GAAI,CAACJ,KAAK,CAACP,MAAM,CAAE,CACjBO,KAAK,CAACP,MAAM,CAAG,CAAC,CAAC,CACnB,CACAO,KAAK,CAACP,MAAM,CAACY,eAAe,CAACC,OAAO,CAAC,CAAGN,KAAK,CAACP,MAAM,CAACY,eAAe,CAACC,OAAO,CAAC,EAAI,CAAC,CAAC,CACnFN,KAAK,CAACP,MAAM,CAACY,eAAe,CAACC,OAAO,CAAC,CAACD,eAAe,CAACE,OAAO,CAAC,CAAGF,eAAe,CAChFL,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAAC1B,qBAAqB,CAAE,CAAC2B,KAAK,CAAAQ,KAAA,GAAwC,IAAtC,CAAEL,OAAO,CAAE,CAAEI,OAAO,CAAED,OAAQ,CAAE,CAAC,CAAAE,KAAA,CACvE,GAAI,CAACR,KAAK,CAACP,MAAM,CAAE,CACjBO,KAAK,CAACP,MAAM,CAAG,CAAC,CAAC,CACnB,CACAO,KAAK,CAACP,MAAM,CAACa,OAAO,CAAC,CAAGN,KAAK,CAACP,MAAM,CAACa,OAAO,CAAC,EAAI,CAAC,CAAC,CACnD,MAAO,CAAAN,KAAK,CAACP,MAAM,CAACa,OAAO,CAAC,CAACC,OAAO,CAAC,CACrCP,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAAC7B,iBAAiB,CAAE,CAAC8B,KAAK,CAAAS,KAAA,GAAsC,IAApC,CAAEN,OAAO,CAAE,CAAEO,cAAe,CAAE,CAAC,CAAAD,KAAA,CACjE,GACEC,cAAc,CAACC,MAAM,CAACL,OAAO,GAAKI,cAAc,CAACE,MAAM,CAACN,OAAO,EAC/DI,cAAc,CAACC,MAAM,CAACJ,OAAO,GAAKG,cAAc,CAACE,MAAM,CAACL,OAAO,CAC/D,CACA,KAAM,CAAED,OAAQ,CAAC,CAAGI,cAAc,CAACC,MAAM,CACzCX,KAAK,CAACN,KAAK,CAACY,OAAO,CAAC,CAAGN,KAAK,CAACN,KAAK,CAACY,OAAO,CAAC,EAAI,CAAC,CAAC,CACjDN,KAAK,CAACN,KAAK,CAACY,OAAO,CAAC,CAACtB,OAAO,CAAC0B,cAAc,CAACC,MAAM,CAACJ,OAAO,CAAEG,cAAc,CAACE,MAAM,CAACL,OAAO,CAAC,CAAC,CAAGG,cAAc,CAC9G,CACAV,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAAC3B,oBAAoB,CAAE,CAAC4B,KAAK,CAAAa,KAAA,GAA6D,IAA3D,CAAEV,OAAO,CAAE,CAAEG,OAAO,CAAEQ,aAAa,CAAEC,aAAc,CAAE,CAAC,CAAAF,KAAA,CAC3F,GAAIb,KAAK,CAACN,KAAK,CAACY,OAAO,CAAC,CAAE,CACxB;AACA,MAAO,CAAAN,KAAK,CAACN,KAAK,CAACY,OAAO,CAAC,CAACtB,OAAO,CAAC8B,aAAa,CAAEC,aAAa,CAAC,CAAC,CAClE,MAAO,CAAAf,KAAK,CAACN,KAAK,CAACY,OAAO,CAAC,CAACtB,OAAO,CAAC+B,aAAa,CAAED,aAAa,CAAC,CAAC,CACpE,CACAd,KAAK,CAACL,SAAS,CAAGd,gBAAgB,CAAC,CAAC,CACtC,CAAC,CAAC,CACDkB,OAAO,CAACrB,SAAS,CAAGsB,KAAK,EAAK,CAC7BA,KAAK,CAACJ,SAAS,CAAG,KAAK,CACzB,CAAC,CAAC,CACDG,OAAO,CAACpB,WAAW,CAAGqB,KAAK,EAAK,CAC/BA,KAAK,CAACJ,SAAS,CAAG,IAAI,CACxB,CAAC,CAAC,CACDG,OAAO,CAACnB,WAAW,CAAGoB,KAAK,EAAK,CAC/BA,KAAK,CAACH,MAAM,CAAG,CAACG,KAAK,CAACH,MAAM,CAC9B,CAAC,CACL,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}