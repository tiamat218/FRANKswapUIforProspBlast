{"ast":null,"code":"import{CurrencyAmount,JSBI,Percent,TokenAmount}from'@pancakeswap/sdk';import{BLOCKED_PRICE_IMPACT_NON_EXPERT,ALLOWED_PRICE_IMPACT_HIGH,ALLOWED_PRICE_IMPACT_LOW,ALLOWED_PRICE_IMPACT_MEDIUM}from'../config/constants';import{Field}from'../state/swap/actions';import{basisPointsToPercent}from'./index';const BASE_FEE=new Percent(JSBI.BigInt(25),JSBI.BigInt(10000));const ONE_HUNDRED_PERCENT=new Percent(JSBI.BigInt(10000),JSBI.BigInt(10000));const INPUT_FRACTION_AFTER_FEE=ONE_HUNDRED_PERCENT.subtract(BASE_FEE);// computes price breakdown for the trade\nexport function computeTradePriceBreakdown(trade){// for each hop in our trade, take away the x*y=k price impact from 0.3% fees\n// e.g. for 3 tokens/2 hops: 1 - ((1 - .03) * (1-.03))\nconst realizedLPFee=!trade?undefined:ONE_HUNDRED_PERCENT.subtract(trade.route.pairs.reduce(currentFee=>currentFee.multiply(INPUT_FRACTION_AFTER_FEE),ONE_HUNDRED_PERCENT));// remove lp fees from price impact\nconst priceImpactWithoutFeeFraction=trade&&realizedLPFee?trade.priceImpact.subtract(realizedLPFee):undefined;// the x*y=k impact\nconst priceImpactWithoutFeePercent=priceImpactWithoutFeeFraction?new Percent(priceImpactWithoutFeeFraction===null||priceImpactWithoutFeeFraction===void 0?void 0:priceImpactWithoutFeeFraction.numerator,priceImpactWithoutFeeFraction===null||priceImpactWithoutFeeFraction===void 0?void 0:priceImpactWithoutFeeFraction.denominator):undefined;// the amount of the input that accrues to LPs\nconst realizedLPFeeAmount=realizedLPFee&&trade&&(trade.inputAmount instanceof TokenAmount?new TokenAmount(trade.inputAmount.token,realizedLPFee.multiply(trade.inputAmount.raw).quotient):CurrencyAmount.ether(realizedLPFee.multiply(trade.inputAmount.raw).quotient));return{priceImpactWithoutFee:priceImpactWithoutFeePercent,realizedLPFee:realizedLPFeeAmount};}// computes the minimum amount out and maximum amount in for a trade given a user specified allowed slippage in bips\nexport function computeSlippageAdjustedAmounts(trade,allowedSlippage){const pct=basisPointsToPercent(allowedSlippage);return{[Field.INPUT]:trade===null||trade===void 0?void 0:trade.maximumAmountIn(pct),[Field.OUTPUT]:trade===null||trade===void 0?void 0:trade.minimumAmountOut(pct)};}export function warningSeverity(priceImpact){if(!(priceImpact===null||priceImpact===void 0?void 0:priceImpact.lessThan(BLOCKED_PRICE_IMPACT_NON_EXPERT)))return 4;if(!(priceImpact===null||priceImpact===void 0?void 0:priceImpact.lessThan(ALLOWED_PRICE_IMPACT_HIGH)))return 3;if(!(priceImpact===null||priceImpact===void 0?void 0:priceImpact.lessThan(ALLOWED_PRICE_IMPACT_MEDIUM)))return 2;if(!(priceImpact===null||priceImpact===void 0?void 0:priceImpact.lessThan(ALLOWED_PRICE_IMPACT_LOW)))return 1;return 0;}export function formatExecutionPrice(trade,inverted){if(!trade){return'';}return inverted?\"\".concat(trade.executionPrice.invert().toSignificant(6),\" \").concat(trade.inputAmount.currency.symbol,\" / \").concat(trade.outputAmount.currency.symbol):\"\".concat(trade.executionPrice.toSignificant(6),\" \").concat(trade.outputAmount.currency.symbol,\" / \").concat(trade.inputAmount.currency.symbol);}","map":{"version":3,"names":["CurrencyAmount","JSBI","Percent","TokenAmount","BLOCKED_PRICE_IMPACT_NON_EXPERT","ALLOWED_PRICE_IMPACT_HIGH","ALLOWED_PRICE_IMPACT_LOW","ALLOWED_PRICE_IMPACT_MEDIUM","Field","basisPointsToPercent","BASE_FEE","BigInt","ONE_HUNDRED_PERCENT","INPUT_FRACTION_AFTER_FEE","subtract","computeTradePriceBreakdown","trade","realizedLPFee","undefined","route","pairs","reduce","currentFee","multiply","priceImpactWithoutFeeFraction","priceImpact","priceImpactWithoutFeePercent","numerator","denominator","realizedLPFeeAmount","inputAmount","token","raw","quotient","ether","priceImpactWithoutFee","computeSlippageAdjustedAmounts","allowedSlippage","pct","INPUT","maximumAmountIn","OUTPUT","minimumAmountOut","warningSeverity","lessThan","formatExecutionPrice","inverted","concat","executionPrice","invert","toSignificant","currency","symbol","outputAmount"],"sources":["C:/Users/frkul/Documents/swapUI_pancake-frontend/src/utils/prices.ts"],"sourcesContent":["import { CurrencyAmount, Fraction, JSBI, Percent, TokenAmount, Trade } from '@pancakeswap/sdk'\r\nimport {\r\n  BLOCKED_PRICE_IMPACT_NON_EXPERT,\r\n  ALLOWED_PRICE_IMPACT_HIGH,\r\n  ALLOWED_PRICE_IMPACT_LOW,\r\n  ALLOWED_PRICE_IMPACT_MEDIUM,\r\n} from '../config/constants'\r\n\r\nimport { Field } from '../state/swap/actions'\r\nimport { basisPointsToPercent } from './index'\r\n\r\nconst BASE_FEE = new Percent(JSBI.BigInt(25), JSBI.BigInt(10000))\r\nconst ONE_HUNDRED_PERCENT = new Percent(JSBI.BigInt(10000), JSBI.BigInt(10000))\r\nconst INPUT_FRACTION_AFTER_FEE = ONE_HUNDRED_PERCENT.subtract(BASE_FEE)\r\n\r\n// computes price breakdown for the trade\r\nexport function computeTradePriceBreakdown(trade?: Trade | null): {\r\n  priceImpactWithoutFee: Percent | undefined\r\n  realizedLPFee: CurrencyAmount | undefined | null\r\n} {\r\n  // for each hop in our trade, take away the x*y=k price impact from 0.3% fees\r\n  // e.g. for 3 tokens/2 hops: 1 - ((1 - .03) * (1-.03))\r\n  const realizedLPFee = !trade\r\n    ? undefined\r\n    : ONE_HUNDRED_PERCENT.subtract(\r\n        trade.route.pairs.reduce<Fraction>(\r\n          (currentFee: Fraction): Fraction => currentFee.multiply(INPUT_FRACTION_AFTER_FEE),\r\n          ONE_HUNDRED_PERCENT,\r\n        ),\r\n      )\r\n\r\n  // remove lp fees from price impact\r\n  const priceImpactWithoutFeeFraction = trade && realizedLPFee ? trade.priceImpact.subtract(realizedLPFee) : undefined\r\n\r\n  // the x*y=k impact\r\n  const priceImpactWithoutFeePercent = priceImpactWithoutFeeFraction\r\n    ? new Percent(priceImpactWithoutFeeFraction?.numerator, priceImpactWithoutFeeFraction?.denominator)\r\n    : undefined\r\n\r\n  // the amount of the input that accrues to LPs\r\n  const realizedLPFeeAmount =\r\n    realizedLPFee &&\r\n    trade &&\r\n    (trade.inputAmount instanceof TokenAmount\r\n      ? new TokenAmount(trade.inputAmount.token, realizedLPFee.multiply(trade.inputAmount.raw).quotient)\r\n      : CurrencyAmount.ether(realizedLPFee.multiply(trade.inputAmount.raw).quotient))\r\n\r\n  return { priceImpactWithoutFee: priceImpactWithoutFeePercent, realizedLPFee: realizedLPFeeAmount }\r\n}\r\n\r\n// computes the minimum amount out and maximum amount in for a trade given a user specified allowed slippage in bips\r\nexport function computeSlippageAdjustedAmounts(\r\n  trade: Trade | undefined,\r\n  allowedSlippage: number,\r\n): { [field in Field]?: CurrencyAmount } {\r\n  const pct = basisPointsToPercent(allowedSlippage)\r\n  return {\r\n    [Field.INPUT]: trade?.maximumAmountIn(pct),\r\n    [Field.OUTPUT]: trade?.minimumAmountOut(pct),\r\n  }\r\n}\r\n\r\nexport function warningSeverity(priceImpact: Percent | undefined): 0 | 1 | 2 | 3 | 4 {\r\n  if (!priceImpact?.lessThan(BLOCKED_PRICE_IMPACT_NON_EXPERT)) return 4\r\n  if (!priceImpact?.lessThan(ALLOWED_PRICE_IMPACT_HIGH)) return 3\r\n  if (!priceImpact?.lessThan(ALLOWED_PRICE_IMPACT_MEDIUM)) return 2\r\n  if (!priceImpact?.lessThan(ALLOWED_PRICE_IMPACT_LOW)) return 1\r\n  return 0\r\n}\r\n\r\nexport function formatExecutionPrice(trade?: Trade, inverted?: boolean): string {\r\n  if (!trade) {\r\n    return ''\r\n  }\r\n  return inverted\r\n    ? `${trade.executionPrice.invert().toSignificant(6)} ${trade.inputAmount.currency.symbol} / ${\r\n        trade.outputAmount.currency.symbol\r\n      }`\r\n    : `${trade.executionPrice.toSignificant(6)} ${trade.outputAmount.currency.symbol} / ${\r\n        trade.inputAmount.currency.symbol\r\n      }`\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}