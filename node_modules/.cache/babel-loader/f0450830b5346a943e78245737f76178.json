{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/frkul/Documents/swapUI_pancake-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6;import React,{useEffect,useRef,useState}from'react';import{useWeb3React}from'@web3-react/core';import styled,{css,keyframes}from'styled-components';import{Button,CloseIcon,IconButton,TrophyGoldIcon}from'@pancakeswap/uikit';import{CSSTransition}from'react-transition-group';import{useTranslation}from'contexts/Localization';import{getBetHistory}from'state/predictions/helpers';import{useGetPredictionsStatus,useIsHistoryPaneOpen}from'state/hooks';import{useAppDispatch}from'state';import{setHistoryPaneState}from'state/predictions';/**\r\n * @see https://github.com/animate-css/animate.css/tree/main/source\r\n */import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const bounceInKeyframe=keyframes(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  from,\\n  60%,\\n  75%,\\n  90%,\\n  to {\\n    animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);\\n  }\\n\\n  from {\\n    opacity: 0;\\n    transform: translate3d(0, 3000px, 0) scaleY(5);\\n  }\\n\\n  60% {\\n    opacity: 1;\\n    transform: translate3d(0, -20px, 0) scaleY(0.9);\\n  }\\n\\n  75% {\\n    transform: translate3d(0, 10px, 0) scaleY(0.95);\\n  }\\n\\n  90% {\\n    transform: translate3d(0, -5px, 0) scaleY(0.985);\\n  }\\n\\n  to {\\n    transform: translate3d(0, 0, 0);\\n  }\\n\"])));const bounceOutKeyframe=keyframes(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  20% {\\n    transform: translate3d(0, 10px, 0) scaleY(0.985);\\n  }\\n\\n  40%,\\n  45% {\\n    opacity: 1;\\n    transform: translate3d(0, -20px, 0) scaleY(0.9);\\n  }\\n\\n  to {\\n    opacity: 0;\\n    transform: translate3d(0, 2000px, 0) scaleY(3);\\n  }\\n\"])));const bounceInAnimation=css(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  animation: \",\" 1s;\\n\"])),bounceInKeyframe);const bounceOutAnimation=css(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  animation: \",\" 1s;\\n\"])),bounceOutKeyframe);const Wrapper=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  align-items: center;\\n  bottom: 72px;\\n  color: #ffffff;\\n  display: flex;\\n  justify-content: center;\\n  left: 0;\\n  padding-left: 16px;\\n  padding-right: 16px;\\n  position: absolute;\\n  width: 100%;\\n  z-index: 50;\\n\\n  &.popup-enter-active {\\n    \",\"\\n  }\\n\\n  &.popup-enter-done {\\n    bottom: 72px;\\n  }\\n\\n  &.popup-exit-done {\\n    bottom: -2000px;\\n  }\\n\\n  &.popup-exit-active {\\n    \",\"\\n  }\\n\\n  \",\" {\\n    bottom: 16px;\\n    justify-content: flex-end;\\n\\n    &.popup-enter-done {\\n      bottom: 16px;\\n    }\\n  }\\n\"])),bounceInAnimation,bounceOutAnimation,_ref=>{let{theme}=_ref;return theme.mediaQueries.md;});const Popup=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  align-items: center;\\n  background-color: \",\";\\n  border-radius: 32px;\\n  color: #ffffff;\\n  display: flex;\\n  max-width: 320px;\\n  padding: 16px 8px;\\n\"])),_ref2=>{let{theme}=_ref2;return theme.colors.secondary;});const CollectWinningsPopup=()=>{const[isOpen,setIsOpen]=useState(false);const{t}=useTranslation();const ref=useRef(null);const timer=useRef(null);const{account}=useWeb3React();const predictionStatus=useGetPredictionsStatus();const isHistoryPaneOpen=useIsHistoryPaneOpen();const dispatch=useAppDispatch();const handleOpenHistory=()=>{dispatch(setHistoryPaneState(true));};const handleClick=()=>{setIsOpen(false);clearInterval(timer.current);};// Check user's history for unclaimed winners\nuseEffect(()=>{let isCancelled=false;if(account){timer.current=setInterval(async()=>{const bets=await getBetHistory({user:account.toLowerCase(),claimed:false});if(!isCancelled){// Filter out bets that were not winners\nconst winnerBets=bets.filter(bet=>{return bet.position===bet.round.position;});if(!isHistoryPaneOpen){setIsOpen(winnerBets.length>0);}}},30000);}return()=>{clearInterval(timer.current);isCancelled=true;};},[account,timer,predictionStatus,setIsOpen,isHistoryPaneOpen]);// Any time the history pane is open make sure the popup closes\nuseEffect(()=>{if(isHistoryPaneOpen){setIsOpen(false);}},[isHistoryPaneOpen,setIsOpen]);return/*#__PURE__*/_jsx(CSSTransition,{in:isOpen,unmountOnExit:true,nodeRef:ref,timeout:1000,classNames:\"popup\",children:/*#__PURE__*/_jsx(Wrapper,{ref:ref,children:/*#__PURE__*/_jsxs(Popup,{children:[/*#__PURE__*/_jsx(TrophyGoldIcon,{width:\"64px\",style:{flex:'none'},mr:\"8px\"}),/*#__PURE__*/_jsx(Button,{style:{flex:1},onClick:handleOpenHistory,children:t('Collect Winnings')}),/*#__PURE__*/_jsx(IconButton,{variant:\"text\",onClick:handleClick,children:/*#__PURE__*/_jsx(CloseIcon,{color:\"primary\",width:\"24px\"})})]})})});};export default CollectWinningsPopup;","map":{"version":3,"names":["React","useEffect","useRef","useState","useWeb3React","styled","css","keyframes","Button","CloseIcon","IconButton","TrophyGoldIcon","CSSTransition","useTranslation","getBetHistory","useGetPredictionsStatus","useIsHistoryPaneOpen","useAppDispatch","setHistoryPaneState","jsx","_jsx","jsxs","_jsxs","bounceInKeyframe","_templateObject","_taggedTemplateLiteral","bounceOutKeyframe","_templateObject2","bounceInAnimation","_templateObject3","bounceOutAnimation","_templateObject4","Wrapper","div","_templateObject5","_ref","theme","mediaQueries","md","Popup","_templateObject6","_ref2","colors","secondary","CollectWinningsPopup","isOpen","setIsOpen","t","ref","timer","account","predictionStatus","isHistoryPaneOpen","dispatch","handleOpenHistory","handleClick","clearInterval","current","isCancelled","setInterval","bets","user","toLowerCase","claimed","winnerBets","filter","bet","position","round","length","in","unmountOnExit","nodeRef","timeout","classNames","children","width","style","flex","mr","onClick","variant","color"],"sources":["C:/Users/frkul/Documents/swapUI_pancake-frontend/src/views/Predictions/components/CollectWinningsPopup.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react'\r\nimport { useWeb3React } from '@web3-react/core'\r\nimport styled, { css, keyframes } from 'styled-components'\r\nimport { Button, CloseIcon, IconButton, TrophyGoldIcon } from '@pancakeswap/uikit'\r\nimport { CSSTransition } from 'react-transition-group'\r\nimport { useTranslation } from 'contexts/Localization'\r\nimport { getBetHistory } from 'state/predictions/helpers'\r\nimport { useGetPredictionsStatus, useIsHistoryPaneOpen } from 'state/hooks'\r\nimport { useAppDispatch } from 'state'\r\nimport { setHistoryPaneState } from 'state/predictions'\r\n\r\n/**\r\n * @see https://github.com/animate-css/animate.css/tree/main/source\r\n */\r\nconst bounceInKeyframe = keyframes`\r\n  from,\r\n  60%,\r\n  75%,\r\n  90%,\r\n  to {\r\n    animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);\r\n  }\r\n\r\n  from {\r\n    opacity: 0;\r\n    transform: translate3d(0, 3000px, 0) scaleY(5);\r\n  }\r\n\r\n  60% {\r\n    opacity: 1;\r\n    transform: translate3d(0, -20px, 0) scaleY(0.9);\r\n  }\r\n\r\n  75% {\r\n    transform: translate3d(0, 10px, 0) scaleY(0.95);\r\n  }\r\n\r\n  90% {\r\n    transform: translate3d(0, -5px, 0) scaleY(0.985);\r\n  }\r\n\r\n  to {\r\n    transform: translate3d(0, 0, 0);\r\n  }\r\n`\r\n\r\nconst bounceOutKeyframe = keyframes`\r\n  20% {\r\n    transform: translate3d(0, 10px, 0) scaleY(0.985);\r\n  }\r\n\r\n  40%,\r\n  45% {\r\n    opacity: 1;\r\n    transform: translate3d(0, -20px, 0) scaleY(0.9);\r\n  }\r\n\r\n  to {\r\n    opacity: 0;\r\n    transform: translate3d(0, 2000px, 0) scaleY(3);\r\n  }\r\n`\r\n\r\nconst bounceInAnimation = css`\r\n  animation: ${bounceInKeyframe} 1s;\r\n`\r\n\r\nconst bounceOutAnimation = css`\r\n  animation: ${bounceOutKeyframe} 1s;\r\n`\r\n\r\nconst Wrapper = styled.div`\r\n  align-items: center;\r\n  bottom: 72px;\r\n  color: #ffffff;\r\n  display: flex;\r\n  justify-content: center;\r\n  left: 0;\r\n  padding-left: 16px;\r\n  padding-right: 16px;\r\n  position: absolute;\r\n  width: 100%;\r\n  z-index: 50;\r\n\r\n  &.popup-enter-active {\r\n    ${bounceInAnimation}\r\n  }\r\n\r\n  &.popup-enter-done {\r\n    bottom: 72px;\r\n  }\r\n\r\n  &.popup-exit-done {\r\n    bottom: -2000px;\r\n  }\r\n\r\n  &.popup-exit-active {\r\n    ${bounceOutAnimation}\r\n  }\r\n\r\n  ${({ theme }) => theme.mediaQueries.md} {\r\n    bottom: 16px;\r\n    justify-content: flex-end;\r\n\r\n    &.popup-enter-done {\r\n      bottom: 16px;\r\n    }\r\n  }\r\n`\r\n\r\nconst Popup = styled.div`\r\n  align-items: center;\r\n  background-color: ${({ theme }) => theme.colors.secondary};\r\n  border-radius: 32px;\r\n  color: #ffffff;\r\n  display: flex;\r\n  max-width: 320px;\r\n  padding: 16px 8px;\r\n`\r\n\r\nconst CollectWinningsPopup = () => {\r\n  const [isOpen, setIsOpen] = useState(false)\r\n  const { t } = useTranslation()\r\n  const ref = useRef(null)\r\n  const timer = useRef(null)\r\n  const { account } = useWeb3React()\r\n  const predictionStatus = useGetPredictionsStatus()\r\n  const isHistoryPaneOpen = useIsHistoryPaneOpen()\r\n  const dispatch = useAppDispatch()\r\n\r\n  const handleOpenHistory = () => {\r\n    dispatch(setHistoryPaneState(true))\r\n  }\r\n\r\n  const handleClick = () => {\r\n    setIsOpen(false)\r\n    clearInterval(timer.current)\r\n  }\r\n\r\n  // Check user's history for unclaimed winners\r\n  useEffect(() => {\r\n    let isCancelled = false\r\n    if (account) {\r\n      timer.current = setInterval(async () => {\r\n        const bets = await getBetHistory({ user: account.toLowerCase(), claimed: false })\r\n\r\n        if (!isCancelled) {\r\n          // Filter out bets that were not winners\r\n          const winnerBets = bets.filter((bet) => {\r\n            return bet.position === bet.round.position\r\n          })\r\n\r\n          if (!isHistoryPaneOpen) {\r\n            setIsOpen(winnerBets.length > 0)\r\n          }\r\n        }\r\n      }, 30000)\r\n    }\r\n\r\n    return () => {\r\n      clearInterval(timer.current)\r\n      isCancelled = true\r\n    }\r\n  }, [account, timer, predictionStatus, setIsOpen, isHistoryPaneOpen])\r\n\r\n  // Any time the history pane is open make sure the popup closes\r\n  useEffect(() => {\r\n    if (isHistoryPaneOpen) {\r\n      setIsOpen(false)\r\n    }\r\n  }, [isHistoryPaneOpen, setIsOpen])\r\n\r\n  return (\r\n    <CSSTransition in={isOpen} unmountOnExit nodeRef={ref} timeout={1000} classNames=\"popup\">\r\n      <Wrapper ref={ref}>\r\n        <Popup>\r\n          <TrophyGoldIcon width=\"64px\" style={{ flex: 'none' }} mr=\"8px\" />\r\n          <Button style={{ flex: 1 }} onClick={handleOpenHistory}>\r\n            {t('Collect Winnings')}\r\n          </Button>\r\n          <IconButton variant=\"text\" onClick={handleClick}>\r\n            <CloseIcon color=\"primary\" width=\"24px\" />\r\n          </IconButton>\r\n        </Popup>\r\n      </Wrapper>\r\n    </CSSTransition>\r\n  )\r\n}\r\n\r\nexport default CollectWinningsPopup\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}