{"ast":null,"code":"import React,{useEffect}from'react';import{ArrowBackIcon,Box,Button,Flex,Heading}from'@pancakeswap/uikit';import{useWeb3React}from'@web3-react/core';import{Link,useParams}from'react-router-dom';import{useAppDispatch}from'state';import{ProposalState,VotingStateLoadingStatus}from'state/types';import{useGetProposal,useGetVotingStateLoadingStatus,useGetVotes,useGetProposalLoadingStatus}from'state/voting/hooks';import{fetchProposal,fetchVotes,verifyVotes}from'state/voting';import{useTranslation}from'contexts/Localization';import Container from'components/Layout/Container';import ReactMarkdown from'components/ReactMarkdown';import PageLoader from'components/Loader/PageLoader';import{isCoreProposal}from'../helpers';import{ProposalStateTag,ProposalTypeTag}from'../components/Proposals/tags';import Layout from'../components/Layout';import Details from'./Details';import Results from'./Results';import Vote from'./Vote';import Votes from'./Votes';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Proposal=()=>{const{id}=useParams();const proposal=useGetProposal(id);const{t}=useTranslation();const{account}=useWeb3React();const dispatch=useAppDispatch();const votes=useGetVotes(id);const voteLoadingStatus=useGetVotingStateLoadingStatus();const proposalLoadingStatus=useGetProposalLoadingStatus();const hasAccountVoted=account&&votes.some(vote=>vote.voter.toLowerCase()===account.toLowerCase());const{id:proposalId=null,snapshot=null}=proposal!==null&&proposal!==void 0?proposal:{};const isPageLoading=voteLoadingStatus===VotingStateLoadingStatus.LOADING||proposalLoadingStatus===VotingStateLoadingStatus.LOADING;useEffect(()=>{dispatch(fetchProposal(id));},[id,dispatch]);// We have to wait for the proposal to load before fetching the votes because we need to include the snapshot\nuseEffect(()=>{const getVotes=async()=>{await dispatch(fetchVotes({proposalId,block:Number(snapshot)}));dispatch(verifyVotes({proposalId,snapshot}));};if(proposalId&&snapshot){getVotes();}},[proposalId,snapshot,dispatch]);if(!proposal){return/*#__PURE__*/_jsx(PageLoader,{});}return/*#__PURE__*/_jsxs(Container,{py:\"40px\",children:[/*#__PURE__*/_jsx(Box,{mb:\"40px\",children:/*#__PURE__*/_jsx(Button,{as:Link,to:\"/voting\",variant:\"text\",startIcon:/*#__PURE__*/_jsx(ArrowBackIcon,{color:\"primary\",width:\"24px\"}),px:\"0\",children:t('Back to Vote Overview')})}),/*#__PURE__*/_jsxs(Layout,{children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{mb:\"32px\",children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",mb:\"8px\",children:[/*#__PURE__*/_jsx(ProposalStateTag,{proposalState:proposal.state}),/*#__PURE__*/_jsx(ProposalTypeTag,{isCoreProposal:isCoreProposal(proposal),ml:\"8px\"})]}),/*#__PURE__*/_jsx(Heading,{as:\"h1\",scale:\"xl\",mb:\"16px\",children:proposal.title}),/*#__PURE__*/_jsx(Box,{children:/*#__PURE__*/_jsx(ReactMarkdown,{children:proposal.body})})]}),!isPageLoading&&!hasAccountVoted&&proposal.state===ProposalState.ACTIVE&&/*#__PURE__*/_jsx(Vote,{proposal:proposal,mb:\"16px\"}),/*#__PURE__*/_jsx(Votes,{votes:votes})]}),/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Details,{proposal:proposal}),/*#__PURE__*/_jsx(Results,{choices:proposal.choices,votes:votes})]})]})]});};export default Proposal;","map":{"version":3,"names":["React","useEffect","ArrowBackIcon","Box","Button","Flex","Heading","useWeb3React","Link","useParams","useAppDispatch","ProposalState","VotingStateLoadingStatus","useGetProposal","useGetVotingStateLoadingStatus","useGetVotes","useGetProposalLoadingStatus","fetchProposal","fetchVotes","verifyVotes","useTranslation","Container","ReactMarkdown","PageLoader","isCoreProposal","ProposalStateTag","ProposalTypeTag","Layout","Details","Results","Vote","Votes","jsx","_jsx","jsxs","_jsxs","Proposal","id","proposal","t","account","dispatch","votes","voteLoadingStatus","proposalLoadingStatus","hasAccountVoted","some","vote","voter","toLowerCase","proposalId","snapshot","isPageLoading","LOADING","getVotes","block","Number","py","children","mb","as","to","variant","startIcon","color","width","px","alignItems","proposalState","state","ml","scale","title","body","ACTIVE","choices"],"sources":["C:/Users/frkul/Documents/swapUI_pancake-frontend/src/views/Voting/Proposal/index.tsx"],"sourcesContent":["import React, { useEffect } from 'react'\r\nimport { ArrowBackIcon, Box, Button, Flex, Heading } from '@pancakeswap/uikit'\r\nimport { useWeb3React } from '@web3-react/core'\r\nimport { Link, useParams } from 'react-router-dom'\r\nimport { useAppDispatch } from 'state'\r\nimport { ProposalState, VotingStateLoadingStatus } from 'state/types'\r\nimport {\r\n  useGetProposal,\r\n  useGetVotingStateLoadingStatus,\r\n  useGetVotes,\r\n  useGetProposalLoadingStatus,\r\n} from 'state/voting/hooks'\r\nimport { fetchProposal, fetchVotes, verifyVotes } from 'state/voting'\r\nimport { useTranslation } from 'contexts/Localization'\r\nimport Container from 'components/Layout/Container'\r\nimport ReactMarkdown from 'components/ReactMarkdown'\r\nimport PageLoader from 'components/Loader/PageLoader'\r\nimport { isCoreProposal } from '../helpers'\r\nimport { ProposalStateTag, ProposalTypeTag } from '../components/Proposals/tags'\r\nimport Layout from '../components/Layout'\r\nimport Details from './Details'\r\nimport Results from './Results'\r\nimport Vote from './Vote'\r\nimport Votes from './Votes'\r\n\r\nconst Proposal = () => {\r\n  const { id }: { id: string } = useParams()\r\n  const proposal = useGetProposal(id)\r\n  const { t } = useTranslation()\r\n  const { account } = useWeb3React()\r\n  const dispatch = useAppDispatch()\r\n  const votes = useGetVotes(id)\r\n  const voteLoadingStatus = useGetVotingStateLoadingStatus()\r\n  const proposalLoadingStatus = useGetProposalLoadingStatus()\r\n  const hasAccountVoted = account && votes.some((vote) => vote.voter.toLowerCase() === account.toLowerCase())\r\n  const { id: proposalId = null, snapshot = null } = proposal ?? {}\r\n  const isPageLoading =\r\n    voteLoadingStatus === VotingStateLoadingStatus.LOADING || proposalLoadingStatus === VotingStateLoadingStatus.LOADING\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchProposal(id))\r\n  }, [id, dispatch])\r\n\r\n  // We have to wait for the proposal to load before fetching the votes because we need to include the snapshot\r\n  useEffect(() => {\r\n    const getVotes = async () => {\r\n      await dispatch(fetchVotes({ proposalId, block: Number(snapshot) }))\r\n      dispatch(verifyVotes({ proposalId, snapshot }))\r\n    }\r\n\r\n    if (proposalId && snapshot) {\r\n      getVotes()\r\n    }\r\n  }, [proposalId, snapshot, dispatch])\r\n\r\n  if (!proposal) {\r\n    return <PageLoader />\r\n  }\r\n\r\n  return (\r\n    <Container py=\"40px\">\r\n      <Box mb=\"40px\">\r\n        <Button as={Link} to=\"/voting\" variant=\"text\" startIcon={<ArrowBackIcon color=\"primary\" width=\"24px\" />} px=\"0\">\r\n          {t('Back to Vote Overview')}\r\n        </Button>\r\n      </Box>\r\n      <Layout>\r\n        <Box>\r\n          <Box mb=\"32px\">\r\n            <Flex alignItems=\"center\" mb=\"8px\">\r\n              <ProposalStateTag proposalState={proposal.state} />\r\n              <ProposalTypeTag isCoreProposal={isCoreProposal(proposal)} ml=\"8px\" />\r\n            </Flex>\r\n            <Heading as=\"h1\" scale=\"xl\" mb=\"16px\">\r\n              {proposal.title}\r\n            </Heading>\r\n            <Box>\r\n              <ReactMarkdown>{proposal.body}</ReactMarkdown>\r\n            </Box>\r\n          </Box>\r\n          {!isPageLoading && !hasAccountVoted && proposal.state === ProposalState.ACTIVE && (\r\n            <Vote proposal={proposal} mb=\"16px\" />\r\n          )}\r\n          <Votes votes={votes} />\r\n        </Box>\r\n        <Box>\r\n          <Details proposal={proposal} />\r\n          <Results choices={proposal.choices} votes={votes} />\r\n        </Box>\r\n      </Layout>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default Proposal\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}