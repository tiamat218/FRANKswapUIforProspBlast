{"ast":null,"code":"import merge from'lodash/merge';import teamsList from'config/constants/teams';import{getProfileContract}from'utils/contractHelpers';import{multicallv2}from'utils/multicall';import profileABI from'config/abi/pancakeProfile.json';import{getPancakeProfileAddress}from'utils/addressHelpers';const profileContract=getProfileContract();export const getTeam=async teamId=>{try{const{0:teamName,2:numberUsers,3:numberPoints,4:isJoinable}=await profileContract.getTeamProfile(teamId);const staticTeamInfo=teamsList.find(staticTeam=>staticTeam.id===teamId);return merge({},staticTeamInfo,{isJoinable,name:teamName,users:numberUsers.toNumber(),points:numberPoints.toNumber()});}catch(error){return null;}};/**\r\n * Gets on-chain data and merges it with the existing static list of teams\r\n */export const getTeams=async()=>{try{const teamsById=teamsList.reduce((accum,team)=>{return{...accum,[team.id]:team};},{});const nbTeams=await profileContract.numberTeams();const calls=[];for(let i=1;i<=nbTeams;i++){calls.push({address:getPancakeProfileAddress(),name:'getTeamProfile',params:[i]});}const teamData=await multicallv2(profileABI,calls);const onChainTeamData=teamData.reduce((accum,team,index)=>{const{0:teamName,2:numberUsers,3:numberPoints,4:isJoinable}=team;return{...accum,[index+1]:{name:teamName,users:numberUsers.toNumber(),points:numberPoints.toNumber(),isJoinable}};},{});return merge({},teamsById,onChainTeamData);}catch(error){return null;}};","map":{"version":3,"names":["merge","teamsList","getProfileContract","multicallv2","profileABI","getPancakeProfileAddress","profileContract","getTeam","teamId","teamName","numberUsers","numberPoints","isJoinable","getTeamProfile","staticTeamInfo","find","staticTeam","id","name","users","toNumber","points","error","getTeams","teamsById","reduce","accum","team","nbTeams","numberTeams","calls","i","push","address","params","teamData","onChainTeamData","index"],"sources":["C:/Users/frkul/Documents/swapUI_pancake-frontend/src/state/teams/helpers.ts"],"sourcesContent":["import merge from 'lodash/merge'\r\nimport teamsList from 'config/constants/teams'\r\nimport { getProfileContract } from 'utils/contractHelpers'\r\nimport { Team } from 'config/constants/types'\r\nimport { multicallv2 } from 'utils/multicall'\r\nimport { TeamsById } from 'state/types'\r\nimport profileABI from 'config/abi/pancakeProfile.json'\r\nimport { getPancakeProfileAddress } from 'utils/addressHelpers'\r\n\r\nconst profileContract = getProfileContract()\r\n\r\nexport const getTeam = async (teamId: number): Promise<Team> => {\r\n  try {\r\n    const { 0: teamName, 2: numberUsers, 3: numberPoints, 4: isJoinable } = await profileContract.getTeamProfile(teamId)\r\n    const staticTeamInfo = teamsList.find((staticTeam) => staticTeam.id === teamId)\r\n\r\n    return merge({}, staticTeamInfo, {\r\n      isJoinable,\r\n      name: teamName,\r\n      users: numberUsers.toNumber(),\r\n      points: numberPoints.toNumber(),\r\n    })\r\n  } catch (error) {\r\n    return null\r\n  }\r\n}\r\n\r\n/**\r\n * Gets on-chain data and merges it with the existing static list of teams\r\n */\r\nexport const getTeams = async (): Promise<TeamsById> => {\r\n  try {\r\n    const teamsById = teamsList.reduce((accum, team) => {\r\n      return {\r\n        ...accum,\r\n        [team.id]: team,\r\n      }\r\n    }, {})\r\n    const nbTeams = await profileContract.numberTeams()\r\n\r\n    const calls = []\r\n    for (let i = 1; i <= nbTeams; i++) {\r\n      calls.push({\r\n        address: getPancakeProfileAddress(),\r\n        name: 'getTeamProfile',\r\n        params: [i],\r\n      })\r\n    }\r\n    const teamData = await multicallv2(profileABI, calls)\r\n\r\n    const onChainTeamData = teamData.reduce((accum, team, index) => {\r\n      const { 0: teamName, 2: numberUsers, 3: numberPoints, 4: isJoinable } = team\r\n\r\n      return {\r\n        ...accum,\r\n        [index + 1]: {\r\n          name: teamName,\r\n          users: numberUsers.toNumber(),\r\n          points: numberPoints.toNumber(),\r\n          isJoinable,\r\n        },\r\n      }\r\n    }, {})\r\n\r\n    return merge({}, teamsById, onChainTeamData)\r\n  } catch (error) {\r\n    return null\r\n  }\r\n}\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,cAAc,CAChC,MAAO,CAAAC,SAAS,KAAM,wBAAwB,CAC9C,OAASC,kBAAkB,KAAQ,uBAAuB,CAE1D,OAASC,WAAW,KAAQ,iBAAiB,CAE7C,MAAO,CAAAC,UAAU,KAAM,gCAAgC,CACvD,OAASC,wBAAwB,KAAQ,sBAAsB,CAE/D,KAAM,CAAAC,eAAe,CAAGJ,kBAAkB,CAAC,CAAC,CAE5C,MAAO,MAAM,CAAAK,OAAO,CAAG,KAAO,CAAAC,MAAc,EAAoB,CAC9D,GAAI,CACF,KAAM,CAAE,CAAC,CAAEC,QAAQ,CAAE,CAAC,CAAEC,WAAW,CAAE,CAAC,CAAEC,YAAY,CAAE,CAAC,CAAEC,UAAW,CAAC,CAAG,KAAM,CAAAN,eAAe,CAACO,cAAc,CAACL,MAAM,CAAC,CACpH,KAAM,CAAAM,cAAc,CAAGb,SAAS,CAACc,IAAI,CAAEC,UAAU,EAAKA,UAAU,CAACC,EAAE,GAAKT,MAAM,CAAC,CAE/E,MAAO,CAAAR,KAAK,CAAC,CAAC,CAAC,CAAEc,cAAc,CAAE,CAC/BF,UAAU,CACVM,IAAI,CAAET,QAAQ,CACdU,KAAK,CAAET,WAAW,CAACU,QAAQ,CAAC,CAAC,CAC7BC,MAAM,CAAEV,YAAY,CAACS,QAAQ,CAAC,CAChC,CAAC,CAAC,CACJ,CAAE,MAAOE,KAAK,CAAE,CACd,MAAO,KAAI,CACb,CACF,CAAC,CAED;AACA;AACA,GACA,MAAO,MAAM,CAAAC,QAAQ,CAAG,KAAAA,CAAA,GAAgC,CACtD,GAAI,CACF,KAAM,CAAAC,SAAS,CAAGvB,SAAS,CAACwB,MAAM,CAAC,CAACC,KAAK,CAAEC,IAAI,GAAK,CAClD,MAAO,CACL,GAAGD,KAAK,CACR,CAACC,IAAI,CAACV,EAAE,EAAGU,IACb,CAAC,CACH,CAAC,CAAE,CAAC,CAAC,CAAC,CACN,KAAM,CAAAC,OAAO,CAAG,KAAM,CAAAtB,eAAe,CAACuB,WAAW,CAAC,CAAC,CAEnD,KAAM,CAAAC,KAAK,CAAG,EAAE,CAChB,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEA,CAAC,EAAIH,OAAO,CAAEG,CAAC,EAAE,CAAE,CACjCD,KAAK,CAACE,IAAI,CAAC,CACTC,OAAO,CAAE5B,wBAAwB,CAAC,CAAC,CACnCa,IAAI,CAAE,gBAAgB,CACtBgB,MAAM,CAAE,CAACH,CAAC,CACZ,CAAC,CAAC,CACJ,CACA,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAAhC,WAAW,CAACC,UAAU,CAAE0B,KAAK,CAAC,CAErD,KAAM,CAAAM,eAAe,CAAGD,QAAQ,CAACV,MAAM,CAAC,CAACC,KAAK,CAAEC,IAAI,CAAEU,KAAK,GAAK,CAC9D,KAAM,CAAE,CAAC,CAAE5B,QAAQ,CAAE,CAAC,CAAEC,WAAW,CAAE,CAAC,CAAEC,YAAY,CAAE,CAAC,CAAEC,UAAW,CAAC,CAAGe,IAAI,CAE5E,MAAO,CACL,GAAGD,KAAK,CACR,CAACW,KAAK,CAAG,CAAC,EAAG,CACXnB,IAAI,CAAET,QAAQ,CACdU,KAAK,CAAET,WAAW,CAACU,QAAQ,CAAC,CAAC,CAC7BC,MAAM,CAAEV,YAAY,CAACS,QAAQ,CAAC,CAAC,CAC/BR,UACF,CACF,CAAC,CACH,CAAC,CAAE,CAAC,CAAC,CAAC,CAEN,MAAO,CAAAZ,KAAK,CAAC,CAAC,CAAC,CAAEwB,SAAS,CAAEY,eAAe,CAAC,CAC9C,CAAE,MAAOd,KAAK,CAAE,CACd,MAAO,KAAI,CACb,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module"}